<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RentProx - Sign Up</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*{ margin:0; padding:0; box-sizing:border-box; font-family:'Poppins',sans-serif; }
body{ min-height:100vh; background:linear-gradient(135deg,#6C63FF,#8E7CFF); }
.auth-container{
  width:900px; min-height:520px; background:#fff; border-radius:20px;
  display:flex; box-shadow:0 20px 40px rgba(0,0,0,0.15); overflow:hidden;
  margin:80px auto 40px; position:relative; z-index:1;
}
.left{ flex:1.3; padding:45px 50px; display:flex; flex-direction:column; justify-content:center; }
.left h2{ margin-bottom:20px; font-size:1.5rem; color:#333; }
.input-row{ display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:12px; }
.input-group{ margin-bottom:12px; }
.input-group input{
  width:100%; padding:11px 16px; border-radius:25px;
  border:1px solid #ddd; outline:none; font-size:0.88rem; transition:border 0.2s;
}
.input-group input:focus{ border-color:#6C63FF; }
.input-row .input-group{ margin-bottom:0; }
.signup-btn{
  width:100%; padding:12px; border:none; border-radius:25px;
  background:linear-gradient(90deg,#6C63FF,#8E7CFF); color:#fff;
  font-weight:500; cursor:pointer; margin-top:8px; font-size:0.95rem;
}
.signup-btn:hover{ opacity:0.9; }
.signup-btn:disabled{ opacity:0.6; cursor:not-allowed; }
.login-link{ margin-top:14px; font-size:13px; color:#666; }
.login-link a{ color:#6C63FF; text-decoration:none; font-weight:500; }
.right{
  flex:0.8; background:linear-gradient(135deg,#6C63FF,#8E7CFF); color:#fff;
  display:flex; justify-content:center; align-items:center; text-align:center; padding:40px;
}
.right h1{ font-size:26px; margin-bottom:12px; }
.right p{ font-size:0.9rem; opacity:0.85; line-height:1.6; }
.error-msg{ color:#ef4444; font-size:12px; margin-top:5px; margin-left:12px; display:none; }
</style>
</head>
<body>

<nav style="width:100vw;position:fixed;top:0;left:0;background:linear-gradient(90deg,#6C63FF,#8E7CFF);padding:18px 0 18px 40px;z-index:10;box-shadow:0 2px 12px rgba(0,0,0,0.07);">
  <span style="color:#fff;font-size:1.7rem;font-weight:600;letter-spacing:1px;">RentProx</span>
</nav>

<div class="auth-container">
  <div class="left">
    <h2>Create Account</h2>

    <div class="input-row">
      <div class="input-group"><input type="text"  id="inp-name"     placeholder="Full Name"></div>
      <div class="input-group"><input type="email" id="inp-email"    placeholder="Email Address"></div>
    </div>
    <div class="input-row">
      <div class="input-group"><input type="tel"   id="inp-phone"    placeholder="Phone (e.g. 03001234567)"></div>
      <div class="input-group"><input type="text"  id="inp-cnic"     placeholder="CNIC (13 digits)"></div>
    </div>
    <div class="input-group">
      <input type="text" id="inp-address" placeholder="Full Address">
    </div>
    <div class="input-row">
      <div class="input-group"><input type="password" id="inp-password" placeholder="Password"></div>
      <div class="input-group"><input type="password" id="inp-confirm"  placeholder="Confirm Password"></div>
    </div>
    <div class="error-msg" id="pass-error">Passwords match nahi karte.</div>

    <button class="signup-btn" id="signup-btn">SIGN UP</button>
    <div class="login-link">Already have an account? <a href="login_plm.html">Login</a></div>
  </div>

  <div class="right">
    <div>
      <h1>Join RentProx</h1>
      <p>List your property or find your next rental easily and efficiently.</p>
    </div>
  </div>
</div>

<script src="api.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const btn      = document.getElementById('signup-btn');
  const passErr  = document.getElementById('pass-error');

  btn.addEventListener('click', async function () {
    passErr.style.display = 'none';

    const name     = document.getElementById('inp-name').value.trim();
    const email    = document.getElementById('inp-email').value.trim();
    const phone    = document.getElementById('inp-phone').value.trim();
    const cnic     = document.getElementById('inp-cnic').value.trim();
    const address  = document.getElementById('inp-address').value.trim();
    const password = document.getElementById('inp-password').value;
    const confirm  = document.getElementById('inp-confirm').value;

    if (!name || !email || !phone || !cnic || !address || !password || !confirm) {
      passErr.textContent = 'Tamam fields zaruri hain.';
      passErr.style.display = 'block';
      return;
    }
    if (password !== confirm) {
      passErr.textContent = 'Passwords match nahi karte.';
      passErr.style.display = 'block';
      return;
    }

    btn.disabled = true;
    btn.textContent = 'Signing Up...';

    try {
      const data = await apiFetch('/auth/signup', {
        method: 'POST',
        body: JSON.stringify({ name, email, phone, cnic, address, password })
      });

      if (data.success) {
        Auth.save(data.data.token, data.data.user);
        showToast('Account ban gaya! Dashboard par ja rahe hain...');
        setTimeout(() => { window.location.href = 'User/dashboard.html'; }, 1200);
      } else {
        passErr.textContent = data.message || 'Signup fail hua.';
        passErr.style.display = 'block';
      }
    } catch {
      passErr.textContent = 'Server se connect nahi ho saka. Backend chal raha hai?';
      passErr.style.display = 'block';
    } finally {
      btn.disabled = false;
      btn.textContent = 'SIGN UP';
    }
  });
});
</script>
</body>
</html>